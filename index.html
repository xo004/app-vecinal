<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>App Vecinal – Prototipo alpha 0.1</title>
  <style>
    :root{
      --bg:#0f172a;
      --card:#111827;
      --muted:#475569;
      --text:#e5e7eb;
      --accent:#22c55e;
      --danger:#ef4444;
      --warning:#f59e0b;
      --ring:#94a3b8;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif;
      background:linear-gradient(180deg,#0b1224, #0f172a 35%, #0f172a);
      color:var(--text);
    }
    .app{max-width:420px; margin:0 auto; height:100dvh; display:flex; flex-direction:column;}
    header{position:sticky; top:0; z-index:5; padding:14px 16px; background:rgba(15,23,42,.9); backdrop-filter:blur(8px); border-bottom:1px solid #1f2937; display:flex; align-items:center; gap:10px;}
    header h1{font-size:16px;margin:0;font-weight:600;}
    header small{color:var(--muted)}
    .content{flex:1; overflow:auto; padding:16px; display:grid; gap:16px;}
    .card{background:radial-gradient(120% 120% at 100% 0%, #111827 0%, #0f172a 60%); border:1px solid #1f2937; border-radius:14px; padding:14px; box-shadow:0 6px 24px rgba(0,0,0,.25);}
    .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .muted{color:var(--muted); font-size:14px}
    .panic-wrap{display:grid; place-items:center; padding:8px}
    .panic{width:210px; height:210px; border-radius:50%; background:radial-gradient(120% 120% at 70% 30%, #ff6b6b 0%, #ef4444 45%, #b91c1c 100%); border:none; color:white; font-weight:800; font-size:22px; letter-spacing:.5px; box-shadow:0 14px 40px rgba(239,68,68,.45), inset 0 -10px 30px rgba(0,0,0,.35); cursor:pointer; transition:transform .08s ease;}
    .panic:active{ transform:scale(.98); }
    .hint{font-size:13px; color:var(--muted); text-align:center; margin-top:4px}
    .chip{border:1px dashed #334155; color:#cbd5e1; padding:6px 10px; border-radius:999px; font-size:12px}
    .list{display:grid; gap:10px}
    .item{display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border:1px solid #1f2937; border-radius:12px; background:#0b1222}
    .item strong{font-size:14px}
    .badge{font-size:12px; padding:4px 8px; border-radius:999px; background:#1f2937; color:#cbd5e1; border:1px solid #243042}
    .badge.danger{background:#2a1212; color:#fecaca; border-color:#7f1d1d}
    .badge.ok{background:#0f2a19; color:#bbf7d0; border-color:#14532d}
    /* Google Map */
    #map{height:180px; border-radius:14px; border:1px solid #1f2937; margin-top:8px;}
    nav{position:sticky; bottom:0; z-index:5; background:rgba(2,6,23,.9); backdrop-filter:blur(8px); border-top:1px solid #1f2937; display:grid; grid-template-columns:repeat(3,1fr);}
    nav button{padding:12px 8px; background:none; border:none; color:#cbd5e1; font-weight:600; cursor:pointer}
    nav button.active{color:white; border-top:2px solid var(--accent)}
    .hidden{display:none !important}
    .toast{position:fixed; inset:auto 0 78px 0; margin:auto; width:fit-content; max-width:90%; background:#052e1b; color:#d1fae5; border:1px solid #14532d; border-radius:12px; padding:10px 14px; box-shadow:0 10px 30px rgba(0,0,0,.35); opacity:0; transform:translateY(10px); transition:opacity .2s, transform .2s; font-size:14px;}
    .toast.show{opacity:1; transform:translateY(0)}
    .btn{border:1px solid #1f2937; background:#0b1222; color:#e5e7eb; padding:10px 12px; border-radius:10px; cursor:pointer}
    .btn.full{width:100%}
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div>
        <h1>App de Emergencias Vecinales</h1>
        <small class="muted">Prototipo fase alpha 0.1 – Barrio San Sebastian</small>
      </div>
    </header>

    <main class="content">

      <!-- TAB: INICIO -->
      <section id="tab-inicio" class="tab">
        <div class="card">
          <div class="row" style="justify-content:space-between">
            <div>
              <strong>Estado del barrio</strong><br>
              <span class="muted">Última revisión: hoy</span>
            </div>
            <span class="badge danger">Riesgo medio</span>
          </div>
          <div class="panic-wrap">
            <button id="panicBtn" class="panic" aria-label="Botón de pánico">
              SOS
            </button>
            <div id="panicHint" class="hint">Mantén presionado 1.5s para enviar alerta (simulada)</div>
          </div>
          <div class="row">
            <span class="chip">Iluminación limitada</span>
            <span class="chip">Puntos oscuros</span>
            <span class="chip">Patrullaje irregular</span>
          </div>
        </div>

        <div class="card">
          <strong>Zonas seguras / críticas</strong>
          <div id="map"></div>
        </div>
      </section>

      <!-- TAB: ALERTAS -->
      <section id="tab-alertas" class="tab hidden">
        <div class="card">
          <strong>Alertas recientes (simuladas)</strong>
          <div class="list" id="alertList">
            <div class="item"><strong>Alerta de prueba</strong><span class="badge">hoy 08:10</span></div>
            <div class="item"><strong>Vecino reportó luz apagada</strong><span class="badge">ayer 21:35</span></div>
          </div>
          <button class="btn full" id="addFakeAlert">Generar alerta de ejemplo</button>
        </div>
        <div class="card muted">
          *En el prototipo, las alertas no se envían a ningún lugar real; solo se simula la interfaz.
        </div>
      </section>

      <!-- TAB: CONTACTOS -->
      <section id="tab-contactos" class="tab hidden">
        <div class="card">
          <strong>Contactos de emergencia</strong>
          <div class="list" style="margin-top:8px">
            <a class="item" href="tel:105" onclick="return false"><strong>Policía Nacional (105)</strong><span class="badge ok">Llamar</span></a>
            <a class="item" href="tel:116" onclick="return false"><strong>Bomberos (116)</strong><span class="badge ok">Llamar</span></a>
            <a class="item" href="tel:106" onclick="return false"><strong>Ambulancia (106)</strong><span class="badge ok">Llamar</span></a>
            <a class="item" href="tel:084270927" onclick="return false"><strong>Serenasgo</strong><span class="badge ok">Llamar</span></a>
          </div>
        </div>
        <div class="card">
          <strong>Red vecinal</strong>
          <p class="muted" style="margin:8px 0 0">En la versión real aquí iría el enlace al grupo o QR de WhatsApp del barrio.</p>
          <button class="btn" onclick="alert('Mock: abrir enlace de WhatsApp del barrio')">Abrir WhatsApp (mock)</button>
        </div>
      </section>

    </main>

    <nav aria-label="Navegación">
      <button data-tab="inicio" class="active">Inicio</button>
      <button data-tab="alertas">Alertas</button>
      <button data-tab="contactos">Contactos</button>
    </nav>

    <div id="toast" class="toast">Alerta enviada a la red vecinal (simulada)</div>
  </div>

  <script>
    // --- Navegación de tabs ---
    const tabs = {
      inicio: document.getElementById('tab-inicio'),
      alertas: document.getElementById('tab-alertas'),
      contactos: document.getElementById('tab-contactos')
    };
    const navButtons = Array.from(document.querySelectorAll('nav button'));
    function showTab(name){
      Object.entries(tabs).forEach(([k,el]) => el.classList.toggle('hidden', k!==name));
      navButtons.forEach(b => b.classList.toggle('active', b.dataset.tab===name));
    }
    navButtons.forEach(b => b.addEventListener('click', () => showTab(b.dataset.tab)));

    // --- Botón de pánico ---
    const panicBtn = document.getElementById('panicBtn');
    const toast = document.getElementById('toast');
    let holdTimer, isHolding=false;
    function sendMockAlert(){
      if (navigator.vibrate) navigator.vibrate([120, 80, 120]);
      const list = document.getElementById('alertList');
      const item = document.createElement('div');
      item.className = 'item';
      const t = new Date();
      const hh = String(t.getHours()).padStart(2,'0');
      const mm = String(t.getMinutes()).padStart(2,'0');
      item.innerHTML = `<strong>ALERTA SOS (mock)</strong><span class="badge">${hh}:${mm}</span>`;
      list.prepend(item);
      toast.classList.add('show');
      setTimeout(()=> toast.classList.remove('show'), 1800);
    }
    function startHold(){
      isHolding = true;
      holdTimer = setTimeout(()=>{ if(isHolding) sendMockAlert(); }, 1500);
    }
    function endHold(){
      isHolding = false;
      clearTimeout(holdTimer);
    }
    panicBtn.addEventListener('mousedown', startHold);
    panicBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); startHold(); }, {passive:false});
    window.addEventListener('mouseup', endHold);
    window.addEventListener('touchend', endHold);

    // --- Generar alerta fake ---
    document.getElementById('addFakeAlert').addEventListener('click', () => {
      sendMockAlert();
      showTab('alertas');
    });

    // --- Google Maps ---
    function initMap() {
      const barrio = { lat: -13.529116, lng: -71.931186 }; // Barrio san sebastian 
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: barrio,
        styles:[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]}] // estilo opcional
      });
      new google.maps.Marker({position: barrio, map, title: "Barrio"});
    }
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQKvKpQ_x70Hje8T0dywIQC8TIZSL3ajc&callback=initMap"></script>
</body>
</html>

